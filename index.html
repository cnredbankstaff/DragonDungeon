<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dragon Dungeon</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap');
    
    html, body { height: 100%; margin: 0; }
    
    .dungeon-bg {
      background: linear-gradient(180deg, #0a0a0a 0%, #1a0f08 40%, #2d1810 70%, #1a0a0a 100%);
      position: relative;
      overflow: hidden;
    }
    
    .dungeon-bg::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image: 
        radial-gradient(ellipse at 20% 80%, rgba(139, 69, 19, 0.4) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 20%, rgba(139, 69, 19, 0.3) 0%, transparent 40%),
        repeating-linear-gradient(90deg, transparent 0px, transparent 120px, rgba(0,0,0,0.5) 120px, rgba(0,0,0,0.5) 124px),
        repeating-linear-gradient(0deg, transparent 0px, transparent 90px, rgba(0,0,0,0.4) 90px, rgba(0,0,0,0.4) 93px);
      pointer-events: none;
    }
    
    .torch {
      position: absolute;
      width: 24px;
      height: 50px;
      background: linear-gradient(to top, #3a2a0a, #1a0a06);
      border-radius: 3px;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.8);
    }
    
    .torch::before {
      content: '';
      position: absolute;
      top: -35px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 35px;
      background: radial-gradient(ellipse at center bottom, #ff8800, #ff6600, #ff3300, transparent);
      border-radius: 50% 50% 30% 30%;
      animation: flicker 0.4s ease-in-out infinite alternate;
      box-shadow: 0 0 30px rgba(255, 100, 0, 0.8);
    }
    
    .torch::after {
      content: '';
      position: absolute;
      top: -80px;
      left: 50%;
      transform: translateX(-50%);
      width: 150px;
      height: 150px;
      background: radial-gradient(ellipse at center, rgba(255, 120, 30, 0.2), transparent 70%);
      pointer-events: none;
      animation: flicker 0.4s ease-in-out infinite alternate;
    }
    
    @keyframes flicker {
      0% { transform: translateX(-50%) scaleY(1) scaleX(1); opacity: 1; }
      100% { transform: translateX(-50%) scaleY(1.15) scaleX(0.95); opacity: 0.7; }
    }
    
    .player {
      position: absolute;
      transition: all 0.08s ease-out;
      filter: drop-shadow(0 0 8px rgba(100, 200, 255, 0.6)) drop-shadow(0 2px 4px rgba(0,0,0,0.7));
    }
    
    .dragon {
      position: absolute;
      transition: all 0.3s ease-out;
      filter: drop-shadow(0 0 20px rgba(50, 200, 80, 0.5)) drop-shadow(0 4px 8px rgba(0,0,0,0.8));
    }
    
    .fireball {
      position: absolute;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, #ffff44, #ff8800, #ff3300, #cc0000);
      box-shadow: 0 0 25px #ff6600, 0 0 50px #ff3300, inset -2px -2px 8px rgba(0,0,0,0.4);
      animation: burn 0.25s ease-in-out infinite alternate;
    }
    
    @keyframes burn {
      0% { transform: scale(1) brightness(1); box-shadow: 0 0 25px #ff6600, 0 0 50px #ff3300, inset -2px -2px 8px rgba(0,0,0,0.4); }
      100% { transform: scale(1.15) brightness(1.2); box-shadow: 0 0 35px #ffaa00, 0 0 65px #ff5500, inset -2px -2px 8px rgba(0,0,0,0.2); }
    }
    
    .game-over {
      animation: shake 0.6s ease-in-out;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-12px); }
      20%, 40%, 60%, 80% { transform: translateX(12px); }
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }
    
    .skull-icon {
      animation: pulse 1.2s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.12); }
    }
  </style>
</head>
<body class="h-full">
  <div id="game-container" class="dungeon-bg h-full w-full relative select-none overflow-hidden">
    <!-- Torches -->
    <div class="torch" style="top: 60px; left: 40px;"></div>
    <div class="torch" style="top: 60px; right: 40px;"></div>
    <div class="torch" style="bottom: 120px; left: 40px;"></div>
    <div class="torch" style="bottom: 120px; right: 40px;"></div>
    
    <!-- Stone pillars decoration -->
    <div class="absolute top-0 left-20 w-12 h-full bg-gradient-to-r from-stone-900 via-stone-800 to-stone-900 opacity-50"></div>
    <div class="absolute top-0 right-20 w-12 h-full bg-gradient-to-r from-stone-900 via-stone-800 to-stone-900 opacity-50"></div>
    
    <!-- UI -->
    <div class="absolute top-4 left-0 right-0 flex justify-center z-20">
      <h1 id="game-title" class="text-4xl md:text-5xl text-yellow-500 font-bold tracking-wider" style="font-family: 'MedievalSharp', cursive; text-shadow: 0 0 25px rgba(255, 200, 0, 0.7), 3px 3px 6px rgba(0,0,0,0.9), -1px -1px 2px rgba(255,255,255,0.2);">
        Dragon Dungeon
      </h1>
    </div>
    
    <div class="absolute top-20 left-4 z-20 bg-black/70 backdrop-blur rounded-lg px-5 py-3 border-2 border-yellow-700/60 shadow-xl">
      <p class="text-yellow-300 text-sm font-semibold" style="font-family: 'MedievalSharp', cursive;">Score: <span id="score" class="text-yellow-400 text-base">0</span>/20</p>
      <p class="text-yellow-300 text-sm font-semibold" style="font-family: 'MedievalSharp', cursive;">High: <span id="high-score" class="text-yellow-400 text-base">0</span></p>
    </div>
    
    <div class="absolute top-20 right-4 z-20 bg-black/70 backdrop-blur rounded-lg px-5 py-3 border-2 border-yellow-700/60 shadow-xl">
      <p class="text-yellow-300 text-sm font-semibold" style="font-family: 'MedievalSharp', cursive;">‚å®Ô∏è WASD to Move</p>
    </div>
    
    <!-- Player on Dragon -->
    <div id="player" class="player" style="left: 100px; top: 300px;">
      <svg width="140" height="110" viewBox="0 0 140 110">
        <!-- Shadow -->
        <ellipse cx="70" cy="108" rx="55" ry="6" fill="#000" opacity="0.4"/>
        
        <!-- DRAGON BODY (smaller, rideable) -->
        <!-- Back legs -->
        <ellipse cx="35" cy="85" rx="13" ry="20" fill="#2d5a42"/>
        <ellipse cx="38" cy="85" rx="10" ry="18" fill="#3d6b4f"/>
        <ellipse cx="100" cy="85" rx="13" ry="20" fill="#2d5a42"/>
        <ellipse cx="103" cy="85" rx="10" ry="18" fill="#3d6b4f"/>
        
        <!-- Dragon claws back -->
        <path d="M30 103 L26 110 M36 105 L36 112 M42 103 L46 110" stroke="#1a3d2a" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M95 103 L91 110 M101 105 L101 112 M107 103 L111 110" stroke="#1a3d2a" stroke-width="1.5" stroke-linecap="round"/>
        
        <!-- Front legs -->
        <ellipse cx="40" cy="90" rx="12" ry="18" fill="#2d5a42"/>
        <ellipse cx="43" cy="90" rx="9" ry="16" fill="#3d6b4f"/>
        <ellipse cx="105" cy="90" rx="12" ry="18" fill="#2d5a42"/>
        <ellipse cx="108" cy="90" rx="9" ry="16" fill="#3d6b4f"/>
        
        <!-- Dragon claws front -->
        <path d="M35 105 L31 112 M41 107 L41 114 M47 105 L51 112" stroke="#1a3d2a" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M100 105 L96 112 M106 107 L106 114 M112 105 L116 112" stroke="#1a3d2a" stroke-width="1.5" stroke-linecap="round"/>
        
        <!-- Main dragon body -->
        <ellipse cx="70" cy="70" rx="52" ry="35" fill="#4a7c5c" stroke="#2d5a42" stroke-width="2"/>
        <ellipse cx="70" cy="68" rx="48" ry="32" fill="#5a9c6d" opacity="0.7"/>
        
        <!-- Belly scales -->
        <ellipse cx="70" cy="80" rx="32" ry="20" fill="#5a9c6d" opacity="0.8"/>
        <circle cx="55" cy="73" r="3" fill="#6daf7f"/>
        <circle cx="63" cy="78" r="3" fill="#6daf7f"/>
        <circle cx="70" cy="82" r="3" fill="#6daf7f"/>
        <circle cx="77" cy="78" r="3" fill="#6daf7f"/>
        <circle cx="85" cy="73" r="3" fill="#6daf7f"/>
        
        <!-- Tail -->
        <path d="M18 68 Q8 60 0 50" stroke="#3d6b4f" stroke-width="12" fill="none" stroke-linecap="round"/>
        <path d="M18 68 Q8 60 0 50" stroke="#4a7c5c" stroke-width="8" fill="none" stroke-linecap="round" opacity="0.7"/>
        
        <!-- Neck -->
        <path d="M85 55 Q98 42 110 32" stroke="#3d6b4f" stroke-width="22" fill="none" stroke-linecap="round"/>
        <path d="M85 55 Q98 42 110 32" stroke="#4a7c5c" stroke-width="16" fill="none" stroke-linecap="round" opacity="0.7"/>
        
        <!-- DRAGON HEAD -->
        <!-- Head shape -->
        <ellipse cx="115" cy="28" rx="20" ry="18" fill="#4a7c5c" stroke="#2d5a42" stroke-width="1.5"/>
        <ellipse cx="117" cy="26" rx="18" ry="16" fill="#5a9c6d" opacity="0.6"/>
        
        <!-- Horns -->
        <path d="M105 18 Q100 8 102 0 Q108 12 105 18" fill="#1a3d2a"/>
        <path d="M125 16 Q132 6 135 -2 Q130 10 125 16" fill="#1a3d2a"/>
        
        <!-- Head spikes -->
        <path d="M108 16 L108 6 L112 16 Z" fill="#2d5a42"/>
        <path d="M118 14 L119 4 L122 14 Z" fill="#1a3d2a"/>
        
        <!-- Snout -->
        <ellipse cx="98" cy="35" rx="16" ry="12" fill="#3d6b4f" stroke="#2d5a42" stroke-width="1"/>
        <ellipse cx="95" cy="37" rx="12" ry="9" fill="#4a7c5c" opacity="0.6"/>
        
        <!-- Nostrils -->
        <ellipse cx="87" cy="32" rx="4" ry="3" fill="#0d1f16"/>
        <ellipse cx="87" cy="40" rx="4" ry="3" fill="#0d1f16"/>
        
        <!-- Eyes -->
        <circle cx="108" cy="20" r="5" fill="#ffd700"/>
        <ellipse cx="108" cy="21" rx="2.5" ry="4" fill="#000"/>
        <circle cx="110" cy="17" r="1.5" fill="#fff" opacity="0.8"/>
        
        <!-- Wings (folded on sides) -->
        <path d="M50 60 Q35 50 30 70 Q40 80 50 70 Z" fill="#2d5a42" opacity="0.8"/>
        <path d="M50 60 Q38 52 35 68 Q42 76 50 68 Z" fill="#3d6b4f" opacity="0.6"/>
        <path d="M90 60 Q105 50 110 70 Q100 80 90 70 Z" fill="#2d5a42" opacity="0.8"/>
        <path d="M90 60 Q102 52 105 68 Q98 76 90 68 Z" fill="#3d6b4f" opacity="0.6"/>
        
        <!-- KNIGHT RIDER ON DRAGON -->
        <!-- Knight body (sitting on dragon) -->
        <ellipse cx="65" cy="45" rx="10" ry="11" fill="#4a5a6a"/>
        <ellipse cx="65" cy="43" rx="9" ry="10" fill="#6a7a8a"/>
        
        <!-- Knight legs (gripping dragon) -->
        <rect x="56" y="52" width="5" height="12" rx="2" fill="#5a6a7a"/>
        <rect x="74" y="52" width="5" height="12" rx="2" fill="#5a6a7a"/>
        
        <!-- Knight boots -->
        <ellipse cx="58.5" cy="64" rx="4" ry="3" fill="#2a1810"/>
        <ellipse cx="76.5" cy="64" rx="4" ry="3" fill="#2a1810"/>
        
        <!-- Knight arms -->
        <path d="M57 48 Q52 46 50 55" stroke="#5a6a7a" stroke-width="4" fill="none" stroke-linecap="round"/>
        <path d="M73 48 Q78 46 80 55" stroke="#5a6a7a" stroke-width="4" fill="none" stroke-linecap="round"/>
        
        <!-- Sword held high -->
        <rect x="78" y="25" width="3" height="30" fill="#a0b0c0" rx="1"/>
        <rect x="78" y="23" width="3" height="3" fill="#c0d0e0"/>
        <path d="M79.5 23 L77.5 18 L81.5 18 Z" fill="#d0dfe0"/>
        <path d="M75 55 L83 55 L79 59 Z" fill="#8a6a4a"/>
        
        <!-- Knight helmet -->
        <ellipse cx="65" cy="28" rx="11" ry="12" fill="#5a6a7a" stroke="#3a4a5a" stroke-width="1"/>
        <ellipse cx="65" cy="26" rx="9" ry="10" fill="#7a8a9a"/>
        
        <!-- Helmet nose guard -->
        <path d="M65 26 L65 34" stroke="#4a5a6a" stroke-width="1.5"/>
        
        <!-- Visor/Eyes -->
        <ellipse cx="60" cy="27" rx="2.5" ry="2" fill="#1a1a1a"/>
        <ellipse cx="70" cy="27" rx="2.5" ry="2" fill="#1a1a1a"/>
        
        <!-- Eye glow -->
        <circle cx="60" cy="27" r="1" fill="#4a9eff"/>
        <circle cx="70" cy="27" r="1" fill="#4a9eff"/>
        
        <!-- Helmet plume -->
        <path d="M63 22 L62 16 L68 16 L67 22" fill="#c53030"/>
      </svg>
    </div>
    
    <!-- Dragon (enemy) -->
    <div id="dragon" class="dragon" style="right: 100px; top: 150px;">
      <svg width="200" height="160" viewBox="0 0 200 160">
        <defs>
          <radialGradient id="dragonGradient" cx="35%" cy="35%">
            <stop offset="0%" style="stop-color:#5a9c6d;stop-opacity:1" />
            <stop offset="60%" style="stop-color:#3d6b4f;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#1a3d2a;stop-opacity:1" />
          </radialGradient>
          <radialGradient id="scaleGradient" cx="40%" cy="40%">
            <stop offset="0%" style="stop-color:#6daf7f;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#3d6b4f;stop-opacity:1" />
          </radialGradient>
        </defs>
        
        <!-- Shadow -->
        <ellipse cx="100" cy="155" rx="80" ry="8" fill="#000" opacity="0.3"/>
        
        <!-- Back leg -->
        <ellipse cx="70" cy="125" rx="15" ry="28" fill="#1a3d2a"/>
        <ellipse cx="73" cy="125" rx="12" ry="25" fill="#2d5a42"/>
        <ellipse cx="75" cy="123" rx="10" ry="23" fill="#3d6b4f"/>
        <!-- Back foot -->
        <ellipse cx="70" cy="152" rx="16" ry="6" fill="#1a3d2a"/>
        <!-- Back claws -->
        <path d="M58 150 L52 165 M68 153 L68 168 M78 150 L84 165" stroke="#0d1f16" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        
        <!-- Front leg -->
        <ellipse cx="130" cy="132" rx="15" ry="25" fill="#1a3d2a"/>
        <ellipse cx="133" cy="132" rx="12" ry="22" fill="#2d5a42"/>
        <ellipse cx="135" cy="130" rx="10" ry="20" fill="#3d6b4f"/>
        <!-- Front foot -->
        <ellipse cx="130" cy="155" rx="16" ry="6" fill="#1a3d2a"/>
        <!-- Front claws -->
        <path d="M118 153 L110 168 M130 156 L130 171 M142 153 L150 168" stroke="#0d1f16" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        
        <!-- Tail base -->
        <path d="M160 95 Q185 85 195 55 Q200 35 185 30" fill="#2d5a42" stroke="#1a3d2a" stroke-width="2"/>
        <path d="M162 93 Q182 84 192 56 Q196 40 183 33" fill="#4a7c5c"/>
        <ellipse cx="185" cy="70" rx="8" ry="15" fill="#3d6b4f"/>
        
        <!-- Main body -->
        <ellipse cx="105" cy="95" rx="58" ry="40" fill="url(#dragonGradient)" stroke="#1a3d2a" stroke-width="2.5"/>
        <ellipse cx="105" cy="92" rx="50" ry="35" fill="#4a7c5c" opacity="0.6"/>
        
        <!-- Belly scales pattern -->
        <ellipse cx="100" cy="110" rx="32" ry="20" fill="#5a9c6d" opacity="0.8"/>
        <circle cx="82" cy="102" r="3.5" fill="url(#scaleGradient)"/>
        <circle cx="90" cy="106" r="3.5" fill="url(#scaleGradient)"/>
        <circle cx="100" cy="112" r="3.5" fill="url(#scaleGradient)"/>
        <circle cx="110" cy="106" r="3.5" fill="url(#scaleGradient)"/>
        <circle cx="118" cy="102" r="3.5" fill="url(#scaleGradient)"/>
        <circle cx="95" cy="115" r="3" fill="url(#scaleGradient)" opacity="0.7"/>
        <circle cx="105" cy="115" r="3" fill="url(#scaleGradient)" opacity="0.7"/>
        
        <!-- Muscle definition -->
        <path d="M60 90 Q85 78 110 85 Q135 92 150 85" stroke="#1a3d2a" stroke-width="2" fill="none" opacity="0.5"/>
        <path d="M65 105 Q90 110 130 110" stroke="#0d1f16" stroke-width="1.5" fill="none" opacity="0.4"/>
        
        <!-- Left wing -->
        <path d="M75 85 Q35 55 25 95 Q35 115 75 105 Z" fill="#1a3d2a" stroke="#0d1f16" stroke-width="1.5"/>
        <path d="M73 87 Q40 60 32 93 Q40 110 73 103 Z" fill="#2d5a42"/>
        <path d="M71 90 Q50 68 42 88 Q48 105 71 101 Z" fill="#4a7c5c" opacity="0.7"/>
        <!-- Wing membrane veins -->
        <line x1="55" y1="82" x2="40" y2="95" stroke="#0d1f16" stroke-width="1" opacity="0.4"/>
        <line x1="60" y1="88" x2="38" y2="98" stroke="#0d1f16" stroke-width="1" opacity="0.4"/>
        <line x1="65" y1="98" x2="45" y2="102" stroke="#0d1f16" stroke-width="1" opacity="0.4"/>
        
        <!-- Right wing -->
        <path d="M135 85 Q175 55 185 95 Q175 115 135 105 Z" fill="#1a3d2a" stroke="#0d1f16" stroke-width="1.5"/>
        <path d="M137 87 Q170 60 178 93 Q170 110 137 103 Z" fill="#2d5a42"/>
        <path d="M139 90 Q160 68 168 88 Q162 105 139 101 Z" fill="#4a7c5c" opacity="0.7"/>
        <!-- Wing membrane veins -->
        <line x1="155" y1="82" x2="170" y2="95" stroke="#0d1f16" stroke-width="1" opacity="0.4"/>
        <line x1="150" y1="88" x2="172" y2="98" stroke="#0d1f16" stroke-width="1" opacity="0.4"/>
        <line x1="145" y1="98" x2="165" y2="102" stroke="#0d1f16" stroke-width="1" opacity="0.4"/>
        
        <!-- Neck -->
        <path d="M80 80 Q70 55 65 30" stroke="#2d5a42" stroke-width="26" fill="none" stroke-linecap="round"/>
        <path d="M82 80 Q73 55 68 30" stroke="#4a7c5c" stroke-width="20" fill="none" stroke-linecap="round"/>
        <path d="M84 80 Q75 55 70 30" stroke="#5a9c6d" stroke-width="14" fill="none" stroke-linecap="round" opacity="0.7"/>
        
        <!-- Neck detail/scales -->
        <circle cx="76" cy="70" r="3" fill="url(#scaleGradient)"/>
        <circle cx="74" cy="60" r="3" fill="url(#scaleGradient)"/>
        <circle cx="72" cy="50" r="3" fill="url(#scaleGradient)"/>
        <circle cx="70" cy="40" r="3" fill="url(#scaleGradient)"/>
        
        <!-- Head -->
        <ellipse cx="65" cy="25" rx="26" ry="22" fill="url(#dragonGradient)" stroke="#1a3d2a" stroke-width="2"/>
        <ellipse cx="68" cy="22" rx="22" ry="18" fill="#4a7c5c" opacity="0.7"/>
        <ellipse cx="70" cy="20" rx="18" ry="15" fill="#5a9c6d" opacity="0.5"/>
        
        <!-- Snout -->
        <ellipse cx="38" cy="32" rx="20" ry="15" fill="#2d5a42" stroke="#1a3d2a" stroke-width="1.5"/>
        <ellipse cx="35" cy="34" rx="15" ry="11" fill="#4a7c5c" opacity="0.6"/>
        
        <!-- Nostril openings -->
        <ellipse cx="25" cy="28" rx="4.5" ry="3.5" fill="#0d1f16"/>
        <ellipse cx="25" cy="38" rx="4.5" ry="3.5" fill="#0d1f16"/>
        
        <!-- Nostril inner shadow -->
        <ellipse cx="24" cy="28" rx="3" ry="2" fill="#050a08" opacity="0.8"/>
        <ellipse cx="24" cy="38" rx="3" ry="2" fill="#050a08" opacity="0.8"/>
        
        <!-- Eye sockets (deep-set) -->
        <ellipse cx="52" cy="16" rx="9" ry="8" fill="#0d1f16"/>
        <ellipse cx="73" cy="16" rx="9" ry="8" fill="#0d1f16"/>
        
        <!-- Eyes glowing yellow -->
        <ellipse cx="52" cy="16" rx="6.5" ry="5.5" fill="#ffd700"/>
        <ellipse cx="73" cy="16" rx="6.5" ry="5.5" fill="#ffd700"/>
        
        <!-- Eye pupils (vertical slits) -->
        <ellipse cx="52" cy="17" rx="3" ry="5" fill="#000"/>
        <ellipse cx="73" cy="17" rx="3" ry="5" fill="#000"/>
        
        <!-- Eye shine -->
        <circle cx="54" cy="13" r="2.5" fill="#fff" opacity="0.9"/>
        <circle cx="75" cy="13" r="2.5" fill="#fff" opacity="0.9"/>
        
        <!-- Eye inner glow -->
        <circle cx="52" cy="16" r="1.5" fill="#ffff00" opacity="0.6"/>
        <circle cx="73" cy="16" r="1.5" fill="#ffff00" opacity="0.6"/>
        
        <!-- Horns -->
        <path d="M50 6 Q43 -5 38 5 Q43 14 50 6" fill="#0d1f16" stroke="#050a08" stroke-width="1.5"/>
        <path d="M50 6 Q43 -5 38 5" stroke="#1a3d2a" stroke-width="1.5" fill="none"/>
        <path d="M75 4 Q88 -8 95 8 Q88 16 75 4" fill="#0d1f16" stroke="#050a08" stroke-width="1.5"/>
        <path d="M75 4 Q88 -8 95 8" stroke="#1a3d2a" stroke-width="1.5" fill="none"/>
        
        <!-- Head spikes -->
        <path d="M62 6 L63 -6 L66 6 Z" fill="#0d1f16"/>
        <path d="M66 5 L67 -4 L70 5 Z" fill="#1a3d2a"/>
        
        <!-- Jaw definition -->
        <path d="M38 42 Q52 46 65 42" stroke="#1a3d2a" stroke-width="2" fill="none" opacity="0.6"/>
        
        <!-- Steam/smoke effect from nostrils -->
        <circle cx="25" cy="28" r="1.5" fill="#8aa99b" opacity="0.5"/>
        <circle cx="25" cy="38" r="1.5" fill="#8aa99b" opacity="0.5"/>
      </svg>
    </div>
    
    <!-- Fireballs container -->
    <div id="fireballs"></div>
    
    <!-- Game Over Screen -->
    <div id="game-over" class="hidden absolute inset-0 bg-black/85 backdrop-blur-sm flex items-center justify-center z-30">
      <div class="text-center game-over bg-gradient-to-b from-stone-900 to-stone-950 p-10 rounded-2xl border-3 border-red-700/60 shadow-2xl">
        <div class="skull-icon text-7xl mb-6">üíÄ</div>
        <h2 class="text-5xl text-red-600 font-bold mb-4" style="font-family: 'MedievalSharp', cursive; text-shadow: 0 0 25px rgba(220, 38, 38, 0.6), 2px 2px 4px rgba(0,0,0,0.9);">
          You Died!
        </h2>
        <p class="text-yellow-300 text-2xl mb-3 font-semibold" style="font-family: 'MedievalSharp', cursive;">Final Score: <span id="final-score" class="text-yellow-400 text-3xl">0</span>/20</p>
        <p class="text-gray-300 text-lg mb-8" style="font-family: 'MedievalSharp', cursive;">The dragon has claimed another soul...</p>
        <button id="restart-btn" class="px-10 py-4 bg-gradient-to-r from-yellow-700 to-yellow-600 hover:from-yellow-600 hover:to-yellow-500 text-white font-bold text-lg rounded-lg transition-all transform hover:scale-110 active:scale-95 border-2 border-yellow-500/60 shadow-lg" style="font-family: 'MedievalSharp', cursive; text-shadow: 1px 1px 3px rgba(0,0,0,0.6);">
          Rise Again
        </button>
      </div>
    </div>
    
    <!-- Victory Screen -->
    <div id="victory-screen" class="hidden absolute inset-0 bg-black/85 backdrop-blur-sm flex items-center justify-center z-30">
      <div class="text-center bg-gradient-to-b from-yellow-900 to-yellow-950 p-10 rounded-2xl border-3 border-yellow-500/60 shadow-2xl" style="animation: bounce 0.8s ease-in-out;">
        <div class="text-7xl mb-6" style="animation: pulse 1s ease-in-out infinite;">‚öîÔ∏è</div>
        <h2 class="text-5xl text-yellow-400 font-bold mb-4" style="font-family: 'MedievalSharp', cursive; text-shadow: 0 0 25px rgba(250, 204, 21, 0.6), 2px 2px 4px rgba(0,0,0,0.9);">
          Victory!
        </h2>
        <p class="text-yellow-200 text-2xl mb-3 font-semibold" style="font-family: 'MedievalSharp', cursive;">You have vanquished the dragon!</p>
        <p class="text-yellow-300 text-2xl mb-8 font-semibold" style="font-family: 'MedievalSharp', cursive;">Score: <span id="victory-score" class="text-yellow-100 text-3xl">20</span></p>
        <button id="victory-btn" class="px-10 py-4 bg-gradient-to-r from-yellow-700 to-yellow-600 hover:from-yellow-600 hover:to-yellow-500 text-white font-bold text-lg rounded-lg transition-all transform hover:scale-110 active:scale-95 border-2 border-yellow-500/60 shadow-lg" style="font-family: 'MedievalSharp', cursive; text-shadow: 1px 1px 3px rgba(0,0,0,0.6);">
          Play Again
        </button>
      </div>
    </div>
    
    <!-- Start Screen -->
    <div id="start-screen" class="absolute inset-0 bg-black/85 backdrop-blur-sm flex items-center justify-center z-30">
      <div class="text-center bg-gradient-to-b from-stone-900 to-stone-950 p-10 rounded-2xl border-3 border-yellow-700/60 shadow-2xl">
        <div class="text-7xl mb-6 animate-bounce">üêâ</div>
        <h2 class="text-5xl text-yellow-400 font-bold mb-4" style="font-family: 'MedievalSharp', cursive; text-shadow: 0 0 25px rgba(250, 204, 21, 0.6), 2px 2px 4px rgba(0,0,0,0.9);">
          Dragon Dungeon
        </h2>
        <p class="text-yellow-200 text-xl mb-2 font-semibold" style="font-family: 'MedievalSharp', cursive;">‚å®Ô∏è Use W A S D to move</p>
        <p class="text-yellow-200 text-xl mb-8 font-semibold" style="font-family: 'MedievalSharp', cursive;">üî• Dodge 20 fireballs to win!</p>
        <button id="start-btn" class="px-10 py-4 bg-gradient-to-r from-yellow-700 to-yellow-600 hover:from-yellow-600 hover:to-yellow-500 text-white font-bold text-lg rounded-lg transition-all transform hover:scale-110 active:scale-95 border-2 border-yellow-500/60 shadow-lg" style="font-family: 'MedievalSharp', cursive; text-shadow: 1px 1px 3px rgba(0,0,0,0.6);">
          Enter the Dungeon
        </button>
      </div>
    </div>
  </div>

  <script>
    // Audio context and synthesis
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    const sounds = {
      fireballShoot: () => {
        const now = audioContext.currentTime;
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        osc.connect(gain);
        gain.connect(audioContext.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(200, now);
        osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
        gain.gain.setValueAtTime(0.3, now);
        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
        osc.start(now);
        osc.stop(now + 0.1);
      },
      
      fireballHit: () => {
        const now = audioContext.currentTime;
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        osc.connect(gain);
        gain.connect(audioContext.destination);
        osc.type = 'square';
        osc.frequency.setValueAtTime(400, now);
        osc.frequency.exponentialRampToValueAtTime(100, now + 0.15);
        gain.gain.setValueAtTime(0.4, now);
        gain.gain.exponentialRampToValueAtTime(0, now + 0.15);
        osc.start(now);
        osc.stop(now + 0.15);
      },
      
      dodgeSuccess: () => {
        const now = audioContext.currentTime;
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        osc.connect(gain);
        gain.connect(audioContext.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(600, now);
        osc.frequency.exponentialRampToValueAtTime(800, now + 0.1);
        gain.gain.setValueAtTime(0.2, now);
        gain.gain.exponentialRampToValueAtTime(0, now + 0.1);
        osc.start(now);
        osc.stop(now + 0.1);
      },
      
      victory: () => {
        const now = audioContext.currentTime;
        const frequencies = [523.25, 659.25, 783.99]; // C5, E5, G5
        
        frequencies.forEach((freq, index) => {
          const osc = audioContext.createOscillator();
          const gain = audioContext.createGain();
          osc.connect(gain);
          gain.connect(audioContext.destination);
          osc.type = 'sine';
          osc.frequency.setValueAtTime(freq, now + index * 0.15);
          gain.gain.setValueAtTime(0.3, now + index * 0.15);
          gain.gain.exponentialRampToValueAtTime(0, now + index * 0.15 + 0.4);
          osc.start(now + index * 0.15);
          osc.stop(now + index * 0.15 + 0.4);
        });
      },
      
      gameOver: () => {
        const now = audioContext.currentTime;
        const osc = audioContext.createOscillator();
        const gain = audioContext.createGain();
        osc.connect(gain);
        gain.connect(audioContext.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(300, now);
        osc.frequency.exponentialRampToValueAtTime(100, now + 0.5);
        gain.gain.setValueAtTime(0.4, now);
        gain.gain.exponentialRampToValueAtTime(0, now + 0.5);
        osc.start(now);
        osc.stop(now + 0.5);
      }
    };

    const defaultConfig = {
      game_title: "Dragon Dungeon"
    };

    let config = { ...defaultConfig };

    // Game state
    let gameRunning = false;
    let score = 0;
    let highScore = 0;
    let playerX = 100;
    let playerY = 300;
    let dragonX = 0;
    let dragonY = 150;
    let fireballs = [];
    let keys = {};
    let animationId = null;
    let fireballInterval = null;
    const WIN_SCORE = 20;

    const player = document.getElementById('player');
    const dragon = document.getElementById('dragon');
    const fireballsContainer = document.getElementById('fireballs');
    const scoreEl = document.getElementById('score');
    const highScoreEl = document.getElementById('high-score');
    const gameOverScreen = document.getElementById('game-over');
    const victoryScreen = document.getElementById('victory-screen');
    const startScreen = document.getElementById('start-screen');
    const finalScoreEl = document.getElementById('final-score');
    const victorySCoreEl = document.getElementById('victory-score');
    const gameContainer = document.getElementById('game-container');

    // Element SDK setup
    function onConfigChange(cfg) {
      const title = cfg.game_title || defaultConfig.game_title;
      document.getElementById('game-title').textContent = title;
    }

    function mapToCapabilities(cfg) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(cfg) {
      return new Map([
        ["game_title", cfg.game_title || defaultConfig.game_title]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
      config = window.elementSdk.config || config;
    }

    onConfigChange(config);

    // Input handling
    document.addEventListener('keydown', (e) => {
      keys[e.key.toLowerCase()] = true;
    });

    document.addEventListener('keyup', (e) => {
      keys[e.key.toLowerCase()] = false;
    });

    // Start button
    document.getElementById('start-btn').addEventListener('click', startGame);
    document.getElementById('restart-btn').addEventListener('click', startGame);
    document.getElementById('victory-btn').addEventListener('click', startGame);

    function startGame() {
      startScreen.classList.add('hidden');
      gameOverScreen.classList.add('hidden');
      victoryScreen.classList.add('hidden');
      
      score = 0;
      scoreEl.textContent = score;
      
      playerX = 100;
      playerY = gameContainer.offsetHeight / 2;
      
      dragonX = gameContainer.offsetWidth * 0.7;
      dragonY = gameContainer.offsetHeight / 2;
      
      fireballs = [];
      fireballsContainer.innerHTML = '';
      
      gameRunning = true;
      
      if (fireballInterval) clearInterval(fireballInterval);
      fireballInterval = setInterval(spitFire, 1400);
      
      if (animationId) cancelAnimationFrame(animationId);
      gameLoop();
    }

    function spitFire() {
      if (!gameRunning) return;
      
      sounds.fireballShoot();
      
      const dragonMouthX = dragonX + 15;
      const dragonMouthY = dragonY + 35;
      
      const dx = playerX + 30 - dragonMouthX;
      const dy = playerY + 35 - dragonMouthY;
      const dist = Math.sqrt(dx * dx + dy * dy);
      
      const speed = 5.5 + Math.min(score / 12, 6);
      
      fireballs.push({
        x: dragonMouthX,
        y: dragonMouthY,
        vx: (dx / dist) * speed,
        vy: (dy / dist) * speed
      });
      
      const fireballEl = document.createElement('div');
      fireballEl.className = 'fireball';
      fireballEl.style.left = dragonMouthX + 'px';
      fireballEl.style.top = dragonMouthY + 'px';
      fireballsContainer.appendChild(fireballEl);
    }

    function gameLoop() {
      if (!gameRunning) return;
      
      const containerWidth = gameContainer.offsetWidth;
      const containerHeight = gameContainer.offsetHeight;
      
      // Move player
      const speed = 4;
      if (keys['w'] || keys['arrowup']) playerY = Math.max(60, playerY - speed);
      if (keys['s'] || keys['arrowdown']) playerY = Math.min(containerHeight - 60, playerY + speed);
      if (keys['a'] || keys['arrowleft']) playerX = Math.max(0, playerX - speed);
      if (keys['d'] || keys['arrowright']) playerX = Math.min(containerWidth - 60, playerX + speed);
      
      player.style.left = playerX + 'px';
      player.style.top = playerY + 'px';
      
      // Move dragon in a circular pattern throughout the screen
      const time = Date.now() * 0.0003;
      const centerX = containerWidth * 0.6;
      const centerY = containerHeight * 0.5;
      const radiusX = containerWidth * 0.35;
      const radiusY = containerHeight * 0.35;
      
      dragonX = centerX + Math.cos(time) * radiusX - 100;
      dragonY = centerY + Math.sin(time) * radiusY - 80;
      
      // Clamp to bounds
      dragonX = Math.max(0, Math.min(dragonX, containerWidth - 200));
      dragonY = Math.max(50, Math.min(dragonY, containerHeight - 160));
      
      dragon.style.left = dragonX + 'px';
      dragon.style.top = dragonY + 'px';
      
      // Update fireballs
      const fireballEls = fireballsContainer.children;
      for (let i = fireballs.length - 1; i >= 0; i--) {
        const fb = fireballs[i];
        fb.x += fb.vx;
        fb.y += fb.vy;
        
        if (fireballEls[i]) {
          fireballEls[i].style.left = fb.x + 'px';
          fireballEls[i].style.top = fb.y + 'px';
        }
        
        // Check collision with player
        const playerCenterX = playerX + 30;
        const playerCenterY = playerY + 35;
        const fbCenterX = fb.x + 12;
        const fbCenterY = fb.y + 12;
        
        const distance = Math.sqrt(
          Math.pow(playerCenterX - fbCenterX, 2) + 
          Math.pow(playerCenterY - fbCenterY, 2)
        );
        
        if (distance < 35) {
          endGame();
          return;
        }
        
        // Remove if off screen
        if (fb.x < -50 || fb.x > containerWidth + 50 || 
            fb.y < -50 || fb.y > containerHeight + 50) {
          fireballs.splice(i, 1);
          if (fireballEls[i]) fireballEls[i].remove();
          score++;
          scoreEl.textContent = score;
          sounds.dodgeSuccess();
          
          // Check for victory
          if (score >= WIN_SCORE) {
            victory();
            return;
          }
        }
      }
      
      animationId = requestAnimationFrame(gameLoop);
    }

    function endGame() {
      gameRunning = false;
      
      if (fireballInterval) {
        clearInterval(fireballInterval);
        fireballInterval = null;
      }
      
      if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
      }
      
      sounds.gameOver();
      
      if (score > highScore) {
        highScore = score;
        highScoreEl.textContent = highScore;
      }
      
      finalScoreEl.textContent = score;
      gameOverScreen.classList.remove('hidden');
    }

    function victory() {
      gameRunning = false;
      
      if (fireballInterval) {
        clearInterval(fireballInterval);
        fireballInterval = null;
      }
      
      if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
      }
      
      sounds.victory();
      
      if (score > highScore) {
        highScore = score;
        highScoreEl.textContent = highScore;
      }
      
      victorySCoreEl.textContent = score;
      victoryScreen.classList.remove('hidden');
    }

    // Handle window resize
    window.addEventListener('resize', () => {
      if (gameRunning) {
        const containerWidth = gameContainer.offsetWidth;
        const containerHeight = gameContainer.offsetHeight;
        
        playerX = Math.min(playerX, containerWidth - 60);
        playerY = Math.min(playerY, containerHeight - 60);
      }
    });
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cf8455e70f09608',t:'MTc3MTM2MjYyMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
